<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid Traffic Prediction Model | Shyngys Narseyit</title>
    <!-- IBM Plex Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="style.css">
    <!-- Highlight.js for Code Snippets -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
</head>

<body>
    <!-- Top Navigation (Coursera/IBM Style) -->
    <header class="app-header">
        <div class="header-container">
            <div class="brand-logo">
                <span class="logo-mark">SN</span>
                <span class="logo-text">Applied Data Projects</span>
            </div>
            <nav class="main-nav">
                <a href="#overview">Overview</a>
                <a href="#methodology">Methodology</a>
                <a href="#architecture">Architecture</a>
                <a href="#results">Results</a>
            </nav>
            <div class="header-actions">
                <a href="https://github.com/shyngysdesigner/1dCNNandGRU" class="btn btn-primary" target="_blank">
                    <i data-lucide="github"></i> View Repository
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content Layout -->
    <div class="app-layout">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-block">
                <h3 class="sidebar-title">Project Contents</h3>
                <ul class="sidebar-menu">
                    <li><a href="#overview" class="active"><i data-lucide="file-text"></i> 1. Project Overview</a></li>
                    <li><a href="#ideation"><i data-lucide="lightbulb"></i> 2. Concept & Ideation</a></li>
                    <li><a href="#methodology"><i data-lucide="database"></i> 3. Data Engineering</a></li>
                    <li><a href="#architecture"><i data-lucide="cpu"></i> 4. Model Architecture</a></li>
                    <li><a href="#code"><i data-lucide="code"></i> 5. Implementation</a></li>
                    <li><a href="#results"><i data-lucide="bar-chart-2"></i> 6. Evaluation</a></li>
                </ul>
            </div>
            <div class="sidebar-block meta-block">
                <h3 class="sidebar-title">Technologies</h3>
                <div class="tag-list">
                    <span class="tag">PyTorch</span>
                    <span class="tag">Scikit-Learn</span>
                    <span class="tag">Pandas</span>
                    <span class="tag">NumPy</span>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="content-area">

            <!-- Hero Section -->
            <section id="overview" class="page-section section-hero">
                <div class="ibm-label">Deep Learning Case Study</div>
                <h1 class="page-title">Predicting the Unpredictable: Traffic Flow Forecasting</h1>
                <p class="page-subtitle">A high-performance spatial-temporal Hybrid CNN-GRU model engineered to process
                    complex urban traffic networks.</p>

                <div class="hero-stats-grid mt-4">
                    <div class="stat-box">
                        <span class="stat-label">Sensors Processed</span>
                        <span class="stat-value">325</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Timesteps Analyzed</span>
                        <span class="stat-value">52,000+</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Prediction Accuracy (R²)</span>
                        <span class="stat-value highlight">0.633</span>
                    </div>
                </div>
            </section>

            <!-- Ideation -->
            <section id="ideation" class="page-section reveal">
                <h2 class="section-heading">Concept & Ideation</h2>
                <div class="coursera-panel">
                    <div class="panel-content">
                        <h3><i data-lucide="info"></i> The Challenge of Urban Traffic</h3>
                        <p>Traffic is not a simple linear progression. It is an interconnected grid where a congestion
                            event at one location cascades geometrically across other nodes. Traditional time-series
                            models treat data purely chronologically, failing to capture the structural geography of
                            roads.</p>
                        <p class="mt-3"><strong>The Solution: Hybridization</strong></p>
                        <p>By merging a <strong>1-Dimensional Convolutional Neural Network (CNN)</strong> to rapidly
                            compress spatial geography, with a <strong>Gated Recurrent Unit (GRU)</strong> to retain
                            temporal memory, we engineered a model capable of recognizing both <em>where</em> and
                            <em>when</em> traffic patterns emerge.</p>
                    </div>
                </div>
            </section>

            <!-- Methodology -->
            <section id="methodology" class="page-section reveal">
                <h2 class="section-heading">Data Engineering & Transformation</h2>
                <div class="grid-layout cols-2">
                    <div class="data-card">
                        <div class="data-icon"><i data-lucide="waves"></i></div>
                        <h4>Cyclical Temporal Features</h4>
                        <p>Traffic displays strong periodicity (rush hour, weekends). To allow neural networks to
                            interpret "midnight" wrapping back to "morning," continuous variables were mapped into
                            circular coordinate space using sine and cosine transformations.</p>
                    </div>
                    <div class="data-card">
                        <div class="data-icon"><i data-lucide="minimize-2"></i></div>
                        <h4>MinMax Normalization</h4>
                        <p>To accelerate gradient descent and prevent exploding gradients, input velocities across all
                            325 sensors were constrained strictly within a range of [0, 1] using Scikit-Learn's robust
                            scaling methodologies.</p>
                    </div>
                </div>

                <div class="mt-4">
                    <h4>Sliding Window Algorithm</h4>
                    <p class="text-secondary">Generating training sequences by sliding a constant-size temporal window
                        across our time-series dataset.</p>
                    <!-- IBM Data Process UI -->
                    <div class="ibm-process-ui mt-3">
                        <div class="process-track">
                            <div class="data-block block-x">T-11</div>
                            <div class="data-block block-x">...</div>
                            <div class="data-block block-x">T-2</div>
                            <div class="data-block block-x">T-1</div>
                            <div class="data-block block-x current">T=0</div>
                            <div class="arrow-right"><i data-lucide="arrow-right"></i></div>
                            <div class="data-block block-y target">T+1</div>
                        </div>
                        <div class="process-legend mt-3">
                            <span class="legend-item"><span class="color-swatch bg-blue"></span> Input Sequence (X) -> 1
                                Hour / 12 steps</span>
                            <span class="legend-item"><span class="color-swatch bg-green"></span> Prediction Target
                                (y)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Architecture Comparison -->
            <section id="architecture" class="page-section reveal">
                <h2 class="section-heading">Model Architecture</h2>
                <p>A comparative structural analysis of sequence modeling approaches.</p>

                <div class="architecture-grid mt-4">
                    <div class="arch-col disable-col">
                        <div class="arch-header">Pure CNN</div>
                        <ul class="arch-list">
                            <li><i data-lucide="check" class="text-green"></i> Excellent spatial mapping</li>
                            <li><i data-lucide="x" class="text-red"></i> Lacks sequential state memory</li>
                        </ul>
                    </div>
                    <div class="arch-col disable-col">
                        <div class="arch-header">Pure LSTM</div>
                        <ul class="arch-list">
                            <li><i data-lucide="x" class="text-red"></i> Blind to physical geography</li>
                            <li><i data-lucide="check" class="text-green"></i> Strong long-term memory</li>
                        </ul>
                    </div>
                    <div class="arch-col active-col">
                        <div class="ibm-badge">Selected Architecture</div>
                        <div class="arch-header highlight">1D CNN + GRU</div>
                        <ul class="arch-list">
                            <li><i data-lucide="check" class="text-ibm-blue"></i> Fast spatial feature extraction</li>
                            <li><i data-lucide="check" class="text-ibm-blue"></i> Robust temporal retention</li>
                            <li><i data-lucide="check" class="text-ibm-blue"></i> Reduced parameter footprint</li>
                        </ul>
                        <!-- Animated flow within the active column -->
                        <div class="model-flow-diagram mt-3">
                            <div class="node-box cnn-node">Conv1d Layer</div>
                            <div class="flow-arrow-down"></div>
                            <div class="node-box gru-node">GRU Memory Layers</div>
                            <div class="flow-arrow-down"></div>
                            <div class="node-box linear-node">Dense Output</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Implementation -->
            <section id="code" class="page-section reveal">
                <h2 class="section-heading">Core Implementation</h2>
                <p>The PyTorch module defining the dual spatial and temporal propagation phases.</p>
                <div class="ibm-code-block mt-3">
                    <div class="code-header">
                        <span class="file-icon"><i data-lucide="file-code"></i></span>
                        <span class="file-name">traffic_prediction.py</span>
                        <span class="file-lang">Python</span>
                    </div>
                    <pre><code class="language-python">class HybridTrafficModel(nn.Module):
    def __init__(self, num_input_features, num_output_sensors, seq_length):
        super().__init__()
        
        # 1. Spatial Phase (CNN)
        self.conv1 = nn.Conv1d(num_input_features, 64, kernel_size=3, padding=1)
        self.bn1 = nn.BatchNorm1d(64)
        
        # 2. Temporal Phase (GRU)
        self.gru1 = nn.GRU(input_size=64, hidden_size=128, batch_first=True)
        self.gru2 = nn.GRU(input_size=128, hidden_size=64, batch_first=True)
        self.bn2 = nn.BatchNorm1d(64)
        
        # 3. Decision Phase
        self.fc1 = nn.Linear(64, 64)
        self.fc_out = nn.Linear(64, num_output_sensors)
        self.relu = nn.ReLU()
        self.dropout = nn.Dropout(0.2)

    def forward(self, x):
        # Transpose for Conv1d: (Batch, Features, Sequence)
        x = x.permute(0, 2, 1)
        x = self.relu(self.bn1(self.conv1(x)))
        
        # Transpose for GRU: (Batch, Sequence, Features)
        x = x.permute(0, 2, 1)
        x, _ = self.gru1(x)
        x = self.dropout(x)
        x, _ = self.gru2(x)
        
        # Extract the final hidden state
        x = self.dropout(self.bn2(x[:, -1, :]))
        return self.fc_out(self.relu(self.fc1(x)))</code></pre>
                </div>
            </section>

            <!-- Results -->
            <section id="results" class="page-section mb-6 reveal">
                <h2 class="section-heading">Evaluation & Metrics</h2>
                <hr class="ibm-divider">

                <div class="results-dashboard mt-4">
                    <div class="metrics-row">
                        <div class="metric-block">
                            <span class="metric-title">Coefficient of Determination</span>
                            <div class="metric-value text-ibm-blue count-up" data-target="0.633">0.000</div>
                            <span class="metric-unit">R² Score</span>
                        </div>
                        <div class="metric-block">
                            <span class="metric-title">Mean Absolute Error</span>
                            <div class="metric-value count-up" data-target="2.348">0.000</div>
                            <span class="metric-unit">Velocity Variance</span>
                        </div>
                        <div class="metric-block">
                            <span class="metric-title">Root Mean Squared Error</span>
                            <div class="metric-value count-up" data-target="4.214">0.000</div>
                            <span class="metric-unit">Error Penalty</span>
                        </div>
                    </div>
                </div>

                <div class="coursera-panel mt-4">
                    <img src="traffic_analysis.png" alt="Training Visuals" class="results-chart-img" />
                    <div class="chart-caption">Figure 1.0: Real versus Predicted values over hold-out validation set.
                        Early stopping engaged at epoch constraint to prevent overfitting.</div>
                </div>
            </section>

            <footer class="app-footer">
                <div class="footer-content">
                    <p>&copy; 2026 Shyngys Narseyit. Enterprise Data Solutions.</p>
                    <p class="text-secondary mt-1">Designed following IBM Carbon Design System methodologies.</p>
                </div>
            </footer>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Icons
            lucide.createIcons();

            // Initialize Code highlighting
            hljs.highlightAll();

            // Scroll animations & Metric Count Up
            const revealElements = document.querySelectorAll('.page-section');
            const revealObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');

                        // Handle counter up animation
                        if (entry.target.id === 'results') {
                            const counters = document.querySelectorAll('.count-up');
                            counters.forEach(counter => {
                                if (counter.classList.contains('counted')) return;
                                counter.classList.add('counted');
                                const target = parseFloat(counter.getAttribute('data-target'));
                                const duration = 1200;
                                const steps = 40;
                                const stepTime = duration / steps;
                                let current = 0;
                                const timer = setInterval(() => {
                                    current += target / steps;
                                    if (current >= target) {
                                        current = target;
                                        clearInterval(timer);
                                    }
                                    counter.innerText = current.toFixed(3);
                                }, stepTime);
                            });
                        }
                    }
                });
            }, { threshold: 0.15, rootMargin: "0px 0px -50px 0px" });

            revealElements.forEach(el => revealObserver.observe(el));

            // Sidebar Active state sync
            const sections = document.querySelectorAll('.page-section');
            const navLinks = document.querySelectorAll('.sidebar-menu a');

            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (scrollY >= sectionTop - 100) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>

</html>